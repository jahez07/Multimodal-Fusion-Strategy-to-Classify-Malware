import os.path
from os import listdir
import numpy as np
import imageio
from PIL import Image as im
from numpy import *

path = '/Users/jahezabrahamjohny/Jahez/Research_CyberSecurity/SimHash/SimCode'
path2 = '/Users/jahezabrahamjohny/Jahez/Research_CyberSecurity/SimHash/SimImage'

count = 0

#opening a particular class
for i in (listdir(path)):
  class_name = os.path.basename(os.path.join(path, i))
  # path of particular file in each class
  path3 = path + '/' + i
  print(class_name)
  print(count)

  for j in (listdir(path3)):
    # opening a particular simHash file
    myfile = open(os.path.join(path3, j), "r", errors='ignore')
    file_name = os.path.basename(os.path.join(path3,j))

    content = myfile.read()
    sim = content.split()

    sim_list = []
    for ele in sim:
      el = int(ele)
      sim_list.append(el)

    array_2d = np.array(sim_list).reshape(16, 32) * 242

    image = im.fromarray(array_2d.astype(np.uint8), mode='L')

    #converting the image into RGB mode
    if image.mode != 'RGB':
      image = image.convert('RGB')

    #saving path with class name
    path4 = path2 + '/' + class_name

    # saving the image into target file
    print(file_name)
    imageio.imwrite('{}/{}.png'.format(path4, file_name), image)
    count += 1
