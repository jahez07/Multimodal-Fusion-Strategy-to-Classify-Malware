import os.path
from os import listdir
import numpy as np
import hashlib


path = "/Users/jahezabrahamjohny/Desktop/Jahez/Malware/SimHash/opCode"            #input file’s path
path2 = "/Users/jahezabrahamjohny/Desktop/Jahez/Malware/SimHash/hexCode"      #output file’s path
    

lis = ""
count = 0   #count to know the number of files processed

for i in (listdir(path)):                     #OPENING A PARTICULAR CLASS
    class_name = os.path.basename(os.path.join(path,i)) 
    print(class_name)
    path3 = path+"/"+i  #path of particular file in each clss
    
    for j in(listdir(path3)): 
        output_stream = ""
        file_ = open(os.path.join(path3,j),"r",errors='ignore')    #opening a particular opcode
        
        file_name = os.path.basename(os.path.join(path3,j)) #storing file name
        print(file_name)
        contents = file_.read()
        contents = contents.split() #splitting the content to make each mnemoic code seprate 

        l = "" #temporary variable
        for ele in contents:
            md5_hash = hashlib.md5(ele.encode()).hexdigest()
            l += md5_hash + " "
        
        #addong the string into a varibale to then write it to a file
        output_stream = output_stream + l + "\n"

        path4 = path2 + "/" + class_name
            #         print(path4)

        with open(r'{}/{}.txt'.format(path4, file_name), 'w') as fp:
            fp.write(output_stream)  # writing the valid hexadecimal to the file
