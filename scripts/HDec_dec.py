import os.path
from os import listdir
import numpy as np
import math


path = "/hex_code"            #input file’s path
path2 = "/media/research/TOSHIBA EXT/Big2015/hex_dec"      #output file’s path
    

#lis = ""
#count = 0   #count to know the number of files processed

for i in (listdir(path)):                     #OPENING A PARTICULAR CLASS
    class_name = os.path.basename(os.path.join(path,i)) 
    print(class_name)
    path3 = path+"/"+i  #path of particular file in each clss
    
    for j in(listdir(path3)):
        output_stream = "" # To collect the data to be written
        # To collect each decimal value
        dec_str = ""
        
        # Opening a particular opcode file of an exe
        contents = open(os.path.join(path3,j),"r")
        file_name = os.path.basename(os.path.join(path3,j)) #storing file name
        
        # For the user to see the progress.
        print(file_name)
        for lis in contents:
          hex_list = lis
          hex_list = hex_list.replace('\n', '').split(" ")
          #print(data_list)
          table = {'0': 0, '1': 1, '2': 2, '3': 3,
          '4': 4, '5': 5, '6': 6, '7': 7,
          '8': 8, '9': 9, 'A': 10, 'B': 11,
          'C': 12, 'D': 13, 'E': 14, 'F': 15}
          dec_list = []
          for ele in hex_list:
            hexadecimal = ele.strip().upper()
            res = 0
            size = len(hexadecimal) - 1
            for num in hexadecimal:
              res = res + table[num]*16**size
              size = size - 1
            dec_list.append(res)
          output_stream = output_stream + str(dec_list)

          # Path to write the decimal values
          path4 = path2 + "/" + class_name

          # Creating New Directory
          if not os.path.exists(path4):
             os.mkdir(path4)

          # Opening new file to write the decimal file
          with open(r'{}/{}.txt'.format(path4, file_name), 'w') as fp:
            fp.write(output_stream)  # writing the valid opcode to the file
