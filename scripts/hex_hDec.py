import os.path
from os import listdir
import numpy as np
import math


path = "/home/research/Desktop/Hex_code/hex_code"            #input file’s path
path2 = "/home/research/Desktop/Hex_code/hex_dec"      #output file’s path
    

lis = ""
count = 0   #count to know the number of files processed

for i in (listdir(path)):                     #OPENING A PARTICULAR CLASS
    class_name = os.path.basename(os.path.join(path,i)) 
    print(class_name)
    path3 = path+"/"+i  #path of particular file in each clss
    
    for j in(listdir(path3)):
        output_stream = ""
        file_ = open(os.path.join(path3,j),"r",errors='ignore')    #opening a particular opcode file of an exe
        
        file_name = os.path.basename(os.path.join(path3,j)) #storing file name
        print(file_name)
        contents = file_.read()
#         print(contents)
#         print(contents.count('FF'))
        import re
        hex_regex = r'\b[0-9A-F]{2}\b'
        hex_codes = re.findall(hex_regex, contents)
        hex_str = ""
        for ele in hex_codes:
          hex_str += ele  
#         print(len(hex_codes))
#         print(hex_codes)


        output_stream = output_stream + hex_str

    path4 = path2 + "/" + class_name
        #         print(path4)

    with open(r'{}/{}.txt'.format(path4, file_name), 'w') as fp:
        fp.write(output_stream)  # writing the valid opcode to the file
