path = "/Users/jahezabrahamjohny/Jahez/Research_CyberSecurity/Big2015/dec_entropy"
path2 = "/Users/jahezabrahamjohny/Jahez/Research_CyberSecurity/Big2015/RootNew/EntropyGraph"

import os.path
from os import listdir
import numpy as np
from PIL import Image as im
import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt


count = 0
for i in (listdir(path)):  # OPENING A PARTICULAR CLASS
    class_name = os.path.basename(os.path.join(path, i))
    path3 = path + "/" + i  # path of particular file in each clss
    print(class_name)
    for j in (listdir(path3)):
        myfile = open(os.path.join(path3, j), "r")  #opening a particular opcode file of an exe
        file_name = os.path.basename(os.path.join(path3, j))
        contents = myfile.read()

        # Eliminating spaces
        str_list = contents.replace('\n', '').split(" ")
        # Eliminating ,
        str_list = contents.replace(',', '').split(" ")

        # Appending values of str_list into avg_list
        avg_list = []
        for ele in str_list:
          avg_list.append(ele)

        # Converting avg_list into array and storing values into avg_arr
        avg_arr = np.array(avg_list)

        # striping ] from the last element
        strr = "" # declaring a string variable
        strr = str(avg_arr[-1]) # converting last element of the array into string and storing it in the variable strr
        lst = strr[-1] # assigning the last character of the last element into the lst variable
        strr1 = strr.rstrip(lst) # stripping ] from the last element
        avg_arr[-1] = strr1

        # stripnig [ from the first element
        strr = ""
        strr = str(avg_arr[0])
        first = strr[0]
        strr2 = strr.lstrip(first)
        avg_arr[0] = strr2

        # changing the type of the array from <numpy.str> to <numpy.float>
        avg_arr = avg_arr.astype(float)
        # converting avg_ar into a list and assigned to avg_list
        avg_list = avg_arr.tolist()
        lenn = len(avg_list) # legnth of the list
        # finding the maximum value in the list
        m_val = max(avg_list)

        #x = avg_arr
        # plotting a line graph after changing its width and height
        #f = plt.figure()
        #f.set_figwidth(256)
        #f.set_figheight(256)

        #plt.plot(x, color='red', lw = 5, label = "Darken")
        #plt.xlim(0, 256)
        #plt.ylim(0, m_val)

        #path4 = path2 + "/" + class_name  # saving path with classname
        #print('Saving image from {}'.format(file_name))

        #imageio.imwrite('{}/{}.png'.format(path4, file_name), data)
        #plt.savefig('{}/{}.png'.format(path4, file_name), bbox_inches='tight')

        fig, ax = plt.subplots(figsize=(64/100, 64/100))
        ax.plot(avg_arr, color='red', lw=5, label="Darken")
        ax.set_xlim([0, 256])
        ax.set_ylim([0, m_val])

        path4 = os.path.join(path2, class_name)  # saving path with classname
        print('Saving image from {}'.format(file_name))

        plt.savefig('{}/{}.png'.format(path4, file_name))
        plt.close(fig)